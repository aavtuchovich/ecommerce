<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<head th:replace="fragments/head :: head"></head>
<body>

<div th:replace="fragments/webstore :: webstore"></div>
<nav th:replace="fragments/nav :: nav"></nav>
<div class="container">

    <h2>Корзина</h2>

    <th:block th:if="${cartForm == null || cartForm.cartLines == null || cartForm.cartLines.empty}">
        <h2>Нету товаров в корзине</h2>
        <a th:href="@{/products}">Продолжить покупки</a>
    </th:block>

    <th:block th:if="${cartForm != null && cartForm.cartLines != null && !cartForm.cartLines.empty}">
        <!--/*@thymesVar id="cartForm" type="org.solteh.web.controller.DefaultController"*/-->
        <form method="POST" th:object="${cartForm}" th:action="@{/shoppingCart}">

            <div class="product-preview-container"
                 th:each="cartLineInfo, varStatus : ${cartForm.cartLines}">
                <ul>
                    <li><img class="product-image"
                             th:src="@{|/productImage?code=${cartLineInfo.productInfo.code}|}"/>
                    </li>
                    <li>Код товара: <span th:utext="${cartLineInfo.productInfo.code}"></span>
                        <input type="hidden"
                               th:name="|cartLines[${varStatus.index}].productInfo.code|"
                               th:value="${cartLineInfo.productInfo.code}"/>
                    </li>
                    <li>Название продукта: <span th:utext="${cartLineInfo.productInfo.name}"></span></li>
                    <li>Цена:
                        <span class="price"
                              th:utext="${#numbers.formatDecimal(cartLineInfo.productInfo.price,3,2,'COMMA')}">
                        </span>
                    </li>
                    <li>Количество:
                        <input
                                th:name="|cartLines[${varStatus.index}].quantity|"
                                th:value="${cartLineInfo.quantity}"/>
                    </li>
                    <li>Стоимость:
                        <span class="subtotal"
                              th:utext="${#numbers.formatDecimal(cartLineInfo.amount,3,2,'COMMA')}">
                        </span>
                    </li>
                    <li>
                        <a th:href="@{|/shoppingCartRemoveProduct?code=${cartLineInfo.productInfo.code}|}">
                            Удалить товар
                        </a>
                    </li>
                </ul>
            </div>

            <div style="clear: both"></div>
            <input class="button-update-sc" type="submit" value="Обновить количество"/>
            <a class="navi-item"
               th:href="@{/shoppingCartCustomer}">Добавить информацию</a>
            <a class="navi-item"
               th:href="@{/products}">Продолжить покупки</a>
        </form>
    </th:block>
    <br><br>
</div>
<footer th:replace="fragments/footer :: footer"></footer>
</body>
</html>
